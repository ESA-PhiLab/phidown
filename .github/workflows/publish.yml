# This workflow publishes a Python package to PyPI when a release is created.
name: Upload Python Package to PyPI when a Release is Created

on:
    release:
        types: [created]

jobs:
    pypi-publish:
        name: Publish release to PyPI
        runs-on: ubuntu-latest
        permissions:
            id-token: write # IMPORTANT: mandatory for trusted publishing
        steps:
            - uses: actions/checkout@v4

            - name: Set up Python
                uses: actions/setup-python@v4
                with:
                    python-version: "3.x"

            - name: Set up PDM
                uses: pdm-project/setup-pdm@v4
                with:
                    python-version: "3.x"
                    cache: true

            - name: Build package
                run: pdm build

            - name: Publish package distributions to PyPI
                uses: pypa/gh-action-pypi-publish@release/v1
